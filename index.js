(()=>{"use strict";const e={products:[],filterParams:{brand:[],color:[],year:[],searchQuery:""},filteredProducts:[],cart:[]};function t(e){var t=Object.entries(e).map((function(e){return"string"==typeof e[1]&&""===e[1]||Array.isArray(e)&&0===e[1].length?"":"".concat(e[0],"=").concat(Array.isArray(e[1])?e[1].join(","):e[1])})).filter((function(e){return e})).join("&");return t.length?"?"+t:t}const n=function(){function n(){this.products=e.products,this.filteredProducts=[]}return n.prototype.getProducts=function(e){var n=t(e);return this.filteredProducts=this.products.filter((function(e){return""===n||e.brand.toLowerCase()==="Apple".toLowerCase()||e.brand.toLowerCase()==="Samsung".toLowerCase()?e:void 0})),this.filteredProducts},n}(),r=function(){function e(){}return e.prototype.draw=function(e){var t,n;document.querySelector("#products").innerHTML="";var r=document.createElement("div");if(e.length)e.forEach((function(e){var t=document.createElement("div");t.innerHTML="<h2>".concat(e.title,"</h2>"),r.append(t)})),null===(t=document.querySelector("#products"))||void 0===t||t.append(r);else{var i=document.createElement("div");i.textContent="пока ничего нет",r.append(i),null===(n=document.querySelector("#products"))||void 0===n||n.append(r)}},e}(),i=function(){function e(){this.product=new r}return e.prototype.drawProducts=function(e){var t=null!=e?e:[];this.product.draw(t)},e}();const o=function(){function r(e){this.container=document.createElement("div"),this.container.id=e,this.controller=new n,this.view=new i}return r.prototype.createHeaderTitle=function(e){var t=document.createElement("h1");return t.innerHTML=e,t},r.prototype.createContentPage=function(){var e=document.createElement("template");return e.innerHTML='<div class="products" style="display:flex"> <div class="filter"> <h2>Filter</h2> <div> <form id="formid" method="post" action="/Tests/Post/"> <fieldset> <legend>Brand</legend> <input type="checkbox" name="brand" value="Apple">Apple<br> <input type="checkbox" name="brand" value="Samsung">Samsung<br> </fieldset> <fieldset> <legend>Color</legend> <input type="checkbox" name="color" value="Black">Black<br> <input type="checkbox" name="color" value="White">White<br> </fieldset> </form> <button id="testtt">send</button> </div> </div> <div class="filter"> <h2>Товары</h2> <div id="products"> </div> </div> </div>',e.content.firstChild},r.prototype.enableFilterProducts=function(){this.container.addEventListener("input",(function(n){var r=n.target,i=r.getAttribute("name"),o=r.getAttribute("value");r.checked?e.filterParams[i].push(o):e.filterParams[i]=e.filterParams[i].filter((function(e){return e!==o}));var a=t(e.filterParams);window.history.pushState({},"","/#products"+a)}))},r.prototype.render=function(){var t,n=this,r=this.createHeaderTitle("Products Page"),i=this.createContentPage();return this.container.append(r),this.container.append(i),this.enableFilterProducts(),null===(t=i.querySelector("#testtt"))||void 0===t||t.addEventListener("click",(function(){var t=n.controller.getProducts(e.filterParams);n.view.drawProducts(t)})),this.container},r}(),a=function(){function e(e,t){this.container=document.createElement("div"),this.container.id=e,this.idElem=t}return e.prototype.createHeaderTitle=function(e){var t=document.createElement("h1");return t.innerHTML=e,t},e.prototype.createContentPage=function(){var e;return"".concat(null!==(e=this.idElem)&&void 0!==e?e:this.idElem)},e.prototype.render=function(){var e=this.createHeaderTitle("Product Page");this.container.append(e);var t=this.createContentPage();return this.container.append(t),this.container},e}(),c=function(){function e(e){this.container=document.createElement("div"),this.container.id=e}return e.prototype.createHeaderTitle=function(e){var t=document.createElement("h1");return t.innerHTML=e,t},e.prototype.createContentPage=function(){return"1"},e.prototype.render=function(){var e=this.createHeaderTitle("Cart Page");this.container.append(e);var t=this.createContentPage();return this.container.append(t),this.container},e}(),d=function(){function e(e){this.container=document.createElement("div"),this.container.id=e}return e.prototype.createHeaderTitle=function(e){var t=document.createElement("h1");return t.innerHTML=e,t},e.prototype.createContentPage=function(){return"1"},e.prototype.render=function(){var e=this.createHeaderTitle("Error Page");this.container.append(e);var t=this.createContentPage();return this.container.append(t),this.container},e}();var u=document.createElement("header");u.innerHTML='<div class="header"> <a href="#cart">cart</a> <a href="#products">products</a> <a href="#products?name=1">products?name=1</a> <a href="#product/23">product/23</a> </div>';const s=u,p=function(){function e(e){this.container=document.createElement("div"),this.container.id=e}return e.prototype.createHeaderTitle=function(e){var t=document.createElement("h1");return t.innerHTML=e,t},e.prototype.createContentPage=function(){return"1"},e.prototype.render=function(){var e=this.createHeaderTitle("Main Page");this.container.append(e);var t=this.createContentPage();return this.container.append(t),this.container},e}();function l(e){var t=e.slice(1),n=t.includes("product/")?t.substring(t.indexOf("/")+1,t.length):"",r=t.includes("?")?t.substring(t.indexOf("?")+1,t.length):"";return{hashPage:t,idProduct:n,queryParams:r}}(new(function(){function e(){this.container=document.body,this.controller=new n,this.view=new i,this.initialPage=new p("main-page")}return e.renderNewPage=function(t){var n=t.hashPage,r=t.idProduct,i=(t.queryParams,document.getElementById(e.defaultPageId));i.innerHTML="";var u=null;if(u=""===n?new d("error-page"):"cart"===n?new c("cart-page"):n.includes("products")?new o("products-page"):n.includes("product/")?new a("product-page",r||""):new d("error-page")){var s=u.render();i.append(s)}},e.prototype.enableRouteChange=function(){addEventListener("hashchange",(function(){var t=l(window.location.hash);e.renderNewPage(t)})),window.onpopstate=function(){console.log(window.location.hash.slice(1))}},e.prototype.checkLocation=function(){var t=this.initialPage.render();t.id=e.defaultPageId,this.container.append(t);var n=l(window.location.hash);n.hashPage&&e.renderNewPage(n)},e.prototype.run=function(){var e=this;addEventListener("DOMContentLoaded",(function(){e.container.append(s),e.checkLocation(),e.enableRouteChange()}),!0)},e.defaultPageId="current-page",e}())).run()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWJBLEVBQ0EsSUFBSSxFQUFTLGFBQ2JBLEVBQVNHLFNBQVMsWUFDbEIsSUFBSSxFQUFhLGlCQUNqQkgsRUFBU0csU0FBUyxZQUNsQixJQUFJLEVBQVksZUFBZ0JELEdBQXdCLElBRXhELElBQUksRUFBVSxjQUdmLENBQ04sSUFBTWEsRUFBV0QsRUFBS2xCLFNBQ3RCYyxFQUFZM0MsT0FBT2dELEUsQ0FFM0IsRUFFUSxZQUFBQyxrQkFBUixXQUNJaEMsaUJBQWlCLGNBQWMsV0FDM0IsSUFBSWlDLEVBQXVCbEIsRUFBYU4sT0FBT3lCLFNBQVNDLE1BQ3hEUCxFQUFJSCxjQUFjUSxFQUN0QixJQUVBeEIsT0FBTzJCLFdBQWEsV0FDaEJDLFFBQVFDLElBQUk3QixPQUFPeUIsU0FBU0MsS0FBS2xCLE1BQU0sR0FDM0MsQ0FDSixFQUVRLFlBQUFzQixjQUFSLFdBR0ksSUFBTVIsRUFBV2pFLEtBQUswRCxZQUFZWixTQUNsQ21CLEVBQVMzQyxHQUFLd0MsRUFBSUMsY0FFbEIvRCxLQUFLdUIsVUFBVU4sT0FBT2dELEdBRXRCLElBQUlFLEVBQXVCbEIsRUFBYU4sT0FBT3lCLFNBQVNDLE1BRXBERixFQUFVakIsVUFDVlksRUFBSUgsY0FBY1EsRUFFMUIsRUFFQSxZQUFBTyxJQUFBLHNCQUNJeEMsaUJBQWlCLG9CQUFvQixXQUdqQyxFQUFLWCxVQUFVTixPQUFPLEdBR3RCLEVBQUt3RCxnQkFxQkwsRUFBS1AsbUJBR1QsSUFBRyxFQUVQLEVBNUZlLEVBQUFILGNBQWdCLGVBNkZuQyxDLENBaEdBLEtEUklXLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vbmxpbmUtc3RvcmUvLi9zcmMvY29tcG9uZW50cy9zdGF0ZS9zdGF0ZS50cyIsIndlYnBhY2s6Ly9vbmxpbmUtc3RvcmUvLi9zcmMvdXRpbHMvZ2VuZXJhdGVVUkwudHMiLCJ3ZWJwYWNrOi8vb25saW5lLXN0b3JlLy4vc3JjL2NvbXBvbmVudHMvY29udHJvbGxlci9jb250cm9sbGVyLnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9jb21wb25lbnRzL3ZpZXcvcHJvZHVjdC9pbmRleC50cyIsIndlYnBhY2s6Ly9vbmxpbmUtc3RvcmUvLi9zcmMvY29tcG9uZW50cy92aWV3L2FwcFZpZXcudHMiLCJ3ZWJwYWNrOi8vb25saW5lLXN0b3JlLy4vc3JjL3BhZ2VzL3Byb2R1Y3RzL2luZGV4LnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9wYWdlcy9wcm9kdWN0cy9pbmRleC5odG1sIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9wYWdlcy9wcm9kdWN0L2luZGV4LnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9wYWdlcy9jYXJ0L2luZGV4LnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9wYWdlcy9lcnJvcjQwNC9pbmRleC50cyIsIndlYnBhY2s6Ly9vbmxpbmUtc3RvcmUvLi9zcmMvY29tcG9uZW50cy92aWV3L2hlYWRlci9pbmRleC50cyIsIndlYnBhY2s6Ly9vbmxpbmUtc3RvcmUvLi9zcmMvY29tcG9uZW50cy92aWV3L2hlYWRlci9pbmRleC5odG1sIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9wYWdlcy9tYWluL2luZGV4LnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy91dGlscy9nZXRVUkxQYXJhbXMudHMiLCJ3ZWJwYWNrOi8vb25saW5lLXN0b3JlLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL29ubGluZS1zdG9yZS8uL3NyYy9jb21wb25lbnRzL2FwcC9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi8uLi9wYWdlcy9wcm9kdWN0c1wiO1xuaW1wb3J0IHtGaWx0ZXJQYXJhbXN9IGZyb20gXCIuLi8uLi90eXBlcy9GaWx0ZXJQYXJhbXNcIjtcbmltcG9ydCB7UHJvZHVjdH0gZnJvbSBcIi4uLy4uL3R5cGVzL1Byb2R1Y3RcIjtcblxuaW50ZXJmYWNlIFN0YXRlSW50ZXJmYWNlIHtcbiAgICBwcm9kdWN0czogUHJvZHVjdFtdLFxuICAgIGZpbHRlclBhcmFtczogRmlsdGVyUGFyYW1zLFxuICAgIGZpbHRlcmVkUHJvZHVjdHM6IFByb2R1Y3RzW10sXG4gICAgY2FydDogUHJvZHVjdHNbXSxcbn1cblxuY29uc3QgZGVmYXVsdFN0YXRlOiBTdGF0ZUludGVyZmFjZSA9IHtcbiAgICBwcm9kdWN0czogW10sXG4gICAgZmlsdGVyUGFyYW1zOiB7XG4gICAgICAgIGJyYW5kOiBbXSxcbiAgICAgICAgY29sb3I6IFtdLFxuICAgICAgICB5ZWFyOiBbXSxcbiAgICAgICAgc2VhcmNoUXVlcnk6IFwiXCJcbiAgICB9LFxuICAgIGZpbHRlcmVkUHJvZHVjdHM6IFtdLFxuICAgIGNhcnQ6IFtdXG59XG5cbmV4cG9ydCBkZWZhdWx0IGRlZmF1bHRTdGF0ZSIsImltcG9ydCB7RmlsdGVyUGFyYW1zfSBmcm9tIFwiLi4vdHlwZXMvRmlsdGVyUGFyYW1zXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVVSTChvYmo6IEZpbHRlclBhcmFtcyk6IHN0cmluZyB7XG4gICAgbGV0IHN0ciA9IE9iamVjdC5lbnRyaWVzKG9iaikubWFwKChwYXJhbSkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHBhcmFtWzFdID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAocGFyYW1bMV0gPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW0pKSB7XG4gICAgICAgICAgICBpZiAocGFyYW1bMV0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7cGFyYW1bMF19PSR7QXJyYXkuaXNBcnJheShwYXJhbVsxXSkgPyBwYXJhbVsxXS5qb2luKFwiLFwiKSA6IHBhcmFtWzFdfWBcbiAgICB9KS5maWx0ZXIobiA9PiBuKS5qb2luKFwiJlwiKVxuXG4gICAgaWYgKHN0ci5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFwiP1wiICsgc3RyXG4gICAgfVxuICAgIHJldHVybiBzdHJcbn0iLCJpbXBvcnQge1Byb2R1Y3R9IGZyb20gXCIuLi8uLi90eXBlcy9Qcm9kdWN0XCI7XG5pbXBvcnQge3Byb2R1Y3RzRGF0YX0gZnJvbSBcIi4uLy4uL2RhdGEvcHJvZHVjdHNcIjtcbmltcG9ydCB7RmlsdGVyUGFyYW1zfSBmcm9tIFwiLi4vLi4vdHlwZXMvRmlsdGVyUGFyYW1zXCI7XG5pbXBvcnQge2dlbmVyYXRlVVJMfSBmcm9tIFwiLi4vLi4vdXRpbHMvZ2VuZXJhdGVVUkxcIjtcbmltcG9ydCBkZWZhdWx0U3RhdGUgZnJvbSBcIi4uL3N0YXRlL3N0YXRlXCI7XG5cbmNsYXNzIENvbnRyb2xsZXIge1xuICAgIHByb2R1Y3RzOiBQcm9kdWN0W107XG4gICAgZmlsdGVyZWRQcm9kdWN0czogUHJvZHVjdFtdO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucHJvZHVjdHMgPSBkZWZhdWx0U3RhdGUucHJvZHVjdHNcbiAgICAgICAgdGhpcy5maWx0ZXJlZFByb2R1Y3RzID0gW11cbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0cyhwYXJhbXM6IEZpbHRlclBhcmFtcykge1xuICAgICAgICBsZXQgdXJsID0gZ2VuZXJhdGVVUkwocGFyYW1zKVxuXG4gICAgICAgIHRoaXMuZmlsdGVyZWRQcm9kdWN0cyA9IHRoaXMucHJvZHVjdHMuZmlsdGVyKGVsID0+IHtcbiAgICAgICAgICAgIGlmICh1cmwgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsLmJyYW5kLnRvTG93ZXJDYXNlKCkgPT09IFwiQXBwbGVcIi50b0xvd2VyQ2FzZSgpIHx8IGVsLmJyYW5kLnRvTG93ZXJDYXNlKCkgPT09IFwiU2Ftc3VuZ1wiLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJlZFByb2R1Y3RzXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDb250cm9sbGVyIiwiY2xhc3MgUHJvZHVjdCB7XG4gICAgZHJhdyhkYXRhOiBhbnlbXSkge1xuICAgICAgICAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2R1Y3RzJykgYXMgSFRNTEVsZW1lbnQpLmlubmVySFRNTCA9IFwiXCJcbiAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpdGVtTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICBpdGVtTm9kZS5pbm5lckhUTUwgPSBgPGgyPiR7aXRlbS50aXRsZX08L2gyPmBcbiAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmQoaXRlbU5vZGUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9kdWN0cycpPy5hcHBlbmQoZnJhZ21lbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGl0ZW1Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICAgICAgaXRlbU5vZGUudGV4dENvbnRlbnQgPSBcItC/0L7QutCwINC90LjRh9C10LPQviDQvdC10YJcIlxuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kKGl0ZW1Ob2RlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9kdWN0cycpPy5hcHBlbmQoZnJhZ21lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFByb2R1Y3Q7IiwiaW1wb3J0IFByb2R1Y3QgZnJvbSBcIi4vcHJvZHVjdFwiO1xuXG5leHBvcnQgY2xhc3MgQXBwVmlldyB7XG4gICAgcHJvZHVjdDogUHJvZHVjdDtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcm9kdWN0ID0gbmV3IFByb2R1Y3QoKTtcbiAgICB9XG5cbiAgICBkcmF3UHJvZHVjdHMoZGF0YTogYW55W10pIHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gZGF0YSA/PyBbXTtcbiAgICAgICAgdGhpcy5wcm9kdWN0LmRyYXcodmFsdWVzKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBwVmlldzsiLCJpbXBvcnQgUGFnZUNvbnRlbnQgZnJvbSBcIi4vaW5kZXguaHRtbFwiXG5pbXBvcnQge1Byb2R1Y3R9IGZyb20gXCIuLi8uLi90eXBlcy9Qcm9kdWN0XCI7XG5pbXBvcnQgZGVmYXVsdFN0YXRlIGZyb20gXCIuLi8uLi9jb21wb25lbnRzL3N0YXRlL3N0YXRlXCI7XG5pbXBvcnQge2dlbmVyYXRlVVJMfSBmcm9tIFwiLi4vLi4vdXRpbHMvZ2VuZXJhdGVVUkxcIjtcbmltcG9ydCBDb250cm9sbGVyIGZyb20gXCIuLi8uLi9jb21wb25lbnRzL2NvbnRyb2xsZXIvY29udHJvbGxlclwiO1xuaW1wb3J0IEFwcFZpZXcgZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvdmlldy9hcHBWaWV3XCI7XG5cbmNsYXNzIFByb2R1Y3RzUGFnZSB7XG4gICAgY29udHJvbGxlcjogQ29udHJvbGxlcjtcbiAgICB2aWV3OiBBcHBWaWV3O1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5pZCA9IGlkO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgQ29udHJvbGxlcigpXG4gICAgICAgIHRoaXMudmlldyA9IG5ldyBBcHBWaWV3KClcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUhlYWRlclRpdGxlKHRleHQ6IHN0cmluZykge1xuICAgICAgICBsZXQgaGVhZGVyVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG4gICAgICAgIGhlYWRlclRpdGxlLmlubmVySFRNTCA9IHRleHQ7XG4gICAgICAgIHJldHVybiBoZWFkZXJUaXRsZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNvbnRlbnRQYWdlKCkge1xuICAgICAgICAvLyBjcmVhdGVGaWx0ZXIoKVxuICAgICAgICAvLyBjcmVhdGVQcm9kdWN0c0xpc3QoKVxuXG4gICAgICAgIGxldCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZW1wbGF0ZVwiKTtcbiAgICAgICAgdGVtcGxhdGUuaW5uZXJIVE1MID0gUGFnZUNvbnRlbnQ7XG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0Q2hpbGQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBlbmFibGVGaWx0ZXJQcm9kdWN0cygpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgbGV0IHRhcmdldCA9IGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICAgICAgICAgIGxldCBjYXRlZ29yeSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICAgICAgICAgICAgbGV0IHZhbHVlID0gdGFyZ2V0LmdldEF0dHJpYnV0ZShcInZhbHVlXCIpO1xuICAgICAgICAgICAgaWYgKHRhcmdldC5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGRlZmF1bHRTdGF0ZS5maWx0ZXJQYXJhbXNbY2F0ZWdvcnldLnB1c2godmFsdWUpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICBkZWZhdWx0U3RhdGUuZmlsdGVyUGFyYW1zW2NhdGVnb3J5XSA9IGRlZmF1bHRTdGF0ZS5maWx0ZXJQYXJhbXNbY2F0ZWdvcnldLmZpbHRlcihuID0+IG4gIT09IHZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIGxldCBuZXdVUkwgPSBnZW5lcmF0ZVVSTChkZWZhdWx0U3RhdGUuZmlsdGVyUGFyYW1zKVxuICAgICAgICAgICAgLy8gd2luZG93LmxvY2F0aW9uLmhhc2ggPSBcInByb2R1Y3RzL1wiICsgbmV3VVJMXG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIFwiXCIsIFwiLyNwcm9kdWN0c1wiICsgbmV3VVJMKTtcbiAgICAgICAgfSlcblxuXG5cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy5jcmVhdGVIZWFkZXJUaXRsZShcIlByb2R1Y3RzIFBhZ2VcIilcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY3JlYXRlQ29udGVudFBhZ2UoKVxuXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aXRsZSlcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGNvbnRlbnQpXG4gICAgICAgIHRoaXMuZW5hYmxlRmlsdGVyUHJvZHVjdHMoKVxuICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGVzdHR0XCIpPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHByb2R1Y3RzID0gdGhpcy5jb250cm9sbGVyLmdldFByb2R1Y3RzKGRlZmF1bHRTdGF0ZS5maWx0ZXJQYXJhbXMpXG4gICAgICAgICAgICB0aGlzLnZpZXcuZHJhd1Byb2R1Y3RzKHByb2R1Y3RzKVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXJcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFByb2R1Y3RzUGFnZTsiLCIvLyBNb2R1bGVcbnZhciBjb2RlID0gXCI8ZGl2IGNsYXNzPVxcXCJwcm9kdWN0c1xcXCIgc3R5bGU9XFxcImRpc3BsYXk6ZmxleFxcXCI+IDxkaXYgY2xhc3M9XFxcImZpbHRlclxcXCI+IDxoMj5GaWx0ZXI8L2gyPiA8ZGl2PiA8Zm9ybSBpZD1cXFwiZm9ybWlkXFxcIiBtZXRob2Q9XFxcInBvc3RcXFwiIGFjdGlvbj1cXFwiL1Rlc3RzL1Bvc3QvXFxcIj4gPGZpZWxkc2V0PiA8bGVnZW5kPkJyYW5kPC9sZWdlbmQ+IDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgbmFtZT1cXFwiYnJhbmRcXFwiIHZhbHVlPVxcXCJBcHBsZVxcXCI+QXBwbGU8YnI+IDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgbmFtZT1cXFwiYnJhbmRcXFwiIHZhbHVlPVxcXCJTYW1zdW5nXFxcIj5TYW1zdW5nPGJyPiA8L2ZpZWxkc2V0PiA8ZmllbGRzZXQ+IDxsZWdlbmQ+Q29sb3I8L2xlZ2VuZD4gPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJjb2xvclxcXCIgdmFsdWU9XFxcIkJsYWNrXFxcIj5CbGFjazxicj4gPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJjb2xvclxcXCIgdmFsdWU9XFxcIldoaXRlXFxcIj5XaGl0ZTxicj4gPC9maWVsZHNldD4gPC9mb3JtPiA8YnV0dG9uIGlkPVxcXCJ0ZXN0dHRcXFwiPnNlbmQ8L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8ZGl2IGNsYXNzPVxcXCJmaWx0ZXJcXFwiPiA8aDI+0KLQvtCy0LDRgNGLPC9oMj4gPGRpdiBpZD1cXFwicHJvZHVjdHNcXFwiPiA8L2Rpdj4gPC9kaXY+IDwvZGl2PlwiO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgY29kZTsiLCJjbGFzcyBQcm9kdWN0UGFnZSB7XG4gICAgcHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xuICAgIGlkRWxlbT86IHN0cmluZ1xuXG4gICAgY29uc3RydWN0b3IoaWRUYWc6IHN0cmluZywgaWRFbGVtOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5pZCA9IGlkVGFnXG4gICAgICAgIHRoaXMuaWRFbGVtID0gaWRFbGVtXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVIZWFkZXJUaXRsZSh0ZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGhlYWRlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICAgICAgICBoZWFkZXJUaXRsZS5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgICByZXR1cm4gaGVhZGVyVGl0bGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDb250ZW50UGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuaWRFbGVtID8/IHRoaXMuaWRFbGVtfWBcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy5jcmVhdGVIZWFkZXJUaXRsZShcIlByb2R1Y3QgUGFnZVwiKVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQodGl0bGUpXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmNyZWF0ZUNvbnRlbnRQYWdlKClcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGNvbnRlbnQpXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lclxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUHJvZHVjdFBhZ2U7IiwiY2xhc3MgQ2FydFBhZ2Uge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5pZCA9IGlkXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVIZWFkZXJUaXRsZSh0ZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGhlYWRlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICAgICAgICBoZWFkZXJUaXRsZS5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgICByZXR1cm4gaGVhZGVyVGl0bGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDb250ZW50UGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiMVwiXG4gICAgICAgIC8vIGxldCBoZWFkZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcbiAgICAgICAgLy8gaGVhZGVyVGl0bGUuaW5uZXJIVE1MID0gdGV4dDtcbiAgICAgICAgLy8gcmV0dXJuIGhlYWRlclRpdGxlO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aGlzLmNyZWF0ZUhlYWRlclRpdGxlKFwiQ2FydCBQYWdlXCIpXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aXRsZSlcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY3JlYXRlQ29udGVudFBhZ2UoKVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoY29udGVudClcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJ0UGFnZTsiLCJjbGFzcyBFcnJvclBhZ2Uge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5pZCA9IGlkXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVIZWFkZXJUaXRsZSh0ZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGhlYWRlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICAgICAgICBoZWFkZXJUaXRsZS5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgICByZXR1cm4gaGVhZGVyVGl0bGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDb250ZW50UGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiMVwiXG4gICAgICAgIC8vIGxldCBoZWFkZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcbiAgICAgICAgLy8gaGVhZGVyVGl0bGUuaW5uZXJIVE1MID0gdGV4dDtcbiAgICAgICAgLy8gcmV0dXJuIGhlYWRlclRpdGxlO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aGlzLmNyZWF0ZUhlYWRlclRpdGxlKFwiRXJyb3IgUGFnZVwiKVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQodGl0bGUpXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmNyZWF0ZUNvbnRlbnRQYWdlKClcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGNvbnRlbnQpXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lclxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRXJyb3JQYWdlOyIsImltcG9ydCBIZWFkZXJUZW1wbGF0ZSBmcm9tIFwiLi9pbmRleC5odG1sXCJcblxuY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImhlYWRlclwiKVxuaGVhZGVyLmlubmVySFRNTCA9IEhlYWRlclRlbXBsYXRlXG5cbmV4cG9ydCBkZWZhdWx0IGhlYWRlciIsIi8vIE1vZHVsZVxudmFyIGNvZGUgPSBcIjxkaXYgY2xhc3M9XFxcImhlYWRlclxcXCI+IDxhIGhyZWY9XFxcIiNjYXJ0XFxcIj5jYXJ0PC9hPiA8YSBocmVmPVxcXCIjcHJvZHVjdHNcXFwiPnByb2R1Y3RzPC9hPiA8YSBocmVmPVxcXCIjcHJvZHVjdHM/bmFtZT0xXFxcIj5wcm9kdWN0cz9uYW1lPTE8L2E+IDxhIGhyZWY9XFxcIiNwcm9kdWN0LzIzXFxcIj5wcm9kdWN0LzIzPC9hPiA8L2Rpdj5cIjtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IGNvZGU7IiwiY2xhc3MgTWFpblBhZ2Uge1xuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5pZCA9IGlkXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVIZWFkZXJUaXRsZSh0ZXh0OiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGhlYWRlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICAgICAgICBoZWFkZXJUaXRsZS5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgICByZXR1cm4gaGVhZGVyVGl0bGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDb250ZW50UGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiMVwiXG4gICAgICAgIC8vIGxldCBoZWFkZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcbiAgICAgICAgLy8gaGVhZGVyVGl0bGUuaW5uZXJIVE1MID0gdGV4dDtcbiAgICAgICAgLy8gcmV0dXJuIGhlYWRlclRpdGxlO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aGlzLmNyZWF0ZUhlYWRlclRpdGxlKFwiTWFpbiBQYWdlXCIpXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aXRsZSlcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY3JlYXRlQ29udGVudFBhZ2UoKVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoY29udGVudClcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBNYWluUGFnZTsiLCJpbXBvcnQge1VSTFBhcmFtc30gZnJvbSBcIi4uL3R5cGVzL1VSTFBhcmFtc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VVJMUGFyYW1zKHVybDpzdHJpbmcpOiBVUkxQYXJhbXMge1xuICAgIGxldCBoYXNoUGFnZSA9IHVybC5zbGljZSgxKVxuXG4gICAgbGV0IGlkUHJvZHVjdCA9IGhhc2hQYWdlLmluY2x1ZGVzKFwicHJvZHVjdC9cIilcbiAgICAgICAgPyBoYXNoUGFnZS5zdWJzdHJpbmcoaGFzaFBhZ2UuaW5kZXhPZihcIi9cIikgKyAxLCBoYXNoUGFnZS5sZW5ndGgpXG4gICAgICAgIDogXCJcIlxuXG4gICAgbGV0IHF1ZXJ5UGFyYW1zID0gaGFzaFBhZ2UuaW5jbHVkZXMoXCI/XCIpXG4gICAgICAgID8gaGFzaFBhZ2Uuc3Vic3RyaW5nKGhhc2hQYWdlLmluZGV4T2YoXCI/XCIpICsgMSwgaGFzaFBhZ2UubGVuZ3RoKVxuICAgICAgICA6IFwiXCJcblxuICAgIHJldHVybiB7aGFzaFBhZ2UsIGlkUHJvZHVjdCwgcXVlcnlQYXJhbXN9XG59IiwiaW1wb3J0IEFwcCBmcm9tIFwiLi9jb21wb25lbnRzL2FwcC9hcHBcIjtcblxuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuYXBwLnJ1bigpO1xuXG4iLCJpbXBvcnQgUHJvZHVjdHNQYWdlIGZyb20gXCIuLi8uLi9wYWdlcy9wcm9kdWN0c1wiO1xuaW1wb3J0IFByb2R1Y3RQYWdlIGZyb20gXCIuLi8uLi9wYWdlcy9wcm9kdWN0XCI7XG5pbXBvcnQgQ2FydFBhZ2UgZnJvbSBcIi4uLy4uL3BhZ2VzL2NhcnRcIjtcbmltcG9ydCBFcnJvclBhZ2UgZnJvbSBcIi4uLy4uL3BhZ2VzL2Vycm9yNDA0XCI7XG5pbXBvcnQgSGVhZGVyIGZyb20gXCIuLi92aWV3L2hlYWRlclwiO1xuaW1wb3J0IENvbnRyb2xsZXIgZnJvbSBcIi4uL2NvbnRyb2xsZXIvY29udHJvbGxlclwiO1xuaW1wb3J0IEFwcFZpZXcgZnJvbSBcIi4uL3ZpZXcvYXBwVmlld1wiO1xuaW1wb3J0IE1haW5QYWdlIGZyb20gXCIuLi8uLi9wYWdlcy9tYWluXCI7XG5pbXBvcnQge1VSTFBhcmFtc30gZnJvbSBcIi4uLy4uL3R5cGVzL1VSTFBhcmFtc1wiO1xuaW1wb3J0IHtnZXRVUkxQYXJhbXN9IGZyb20gXCIuLi8uLi91dGlscy9nZXRVUkxQYXJhbXNcIjtcblxuY2xhc3MgQXBwIHtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsUGFnZTogTWFpblBhZ2U7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZGVmYXVsdFBhZ2VJZCA9IFwiY3VycmVudC1wYWdlXCJcbiAgICBwcml2YXRlIGNvbnRyb2xsZXI6IENvbnRyb2xsZXI7XG4gICAgcHJpdmF0ZSB2aWV3OiBBcHBWaWV3O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IENvbnRyb2xsZXIoKVxuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgQXBwVmlldygpO1xuICAgICAgICB0aGlzLmluaXRpYWxQYWdlID0gbmV3IE1haW5QYWdlKFwibWFpbi1wYWdlXCIpXG4gICAgfVxuXG4gICAgc3RhdGljIHJlbmRlck5ld1BhZ2Uoe2hhc2hQYWdlLCBpZFByb2R1Y3QsIHF1ZXJ5UGFyYW1zfTogVVJMUGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYWdlID0gPEhUTUxEaXZFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEFwcC5kZWZhdWx0UGFnZUlkKVxuICAgICAgICBjdXJyZW50UGFnZS5pbm5lckhUTUwgPSBcIlwiXG4gICAgICAgIGxldCBwYWdlOiBDYXJ0UGFnZSB8IFByb2R1Y3RQYWdlIHwgUHJvZHVjdHNQYWdlIHwgRXJyb3JQYWdlIHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGlmIChoYXNoUGFnZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgcGFnZSA9IG5ldyBFcnJvclBhZ2UoXCJlcnJvci1wYWdlXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGhhc2hQYWdlID09PSBcImNhcnRcIikge1xuICAgICAgICAgICAgcGFnZSA9IG5ldyBDYXJ0UGFnZShcImNhcnQtcGFnZVwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChoYXNoUGFnZS5pbmNsdWRlcyhcInByb2R1Y3RzXCIpKSB7XG4gICAgICAgICAgICBwYWdlID0gbmV3IFByb2R1Y3RzUGFnZShcInByb2R1Y3RzLXBhZ2VcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFzaFBhZ2UuaW5jbHVkZXMoXCJwcm9kdWN0L1wiKSkge1xuICAgICAgICAgICAgcGFnZSA9IG5ldyBQcm9kdWN0UGFnZShcInByb2R1Y3QtcGFnZVwiLCBpZFByb2R1Y3QgPyBpZFByb2R1Y3QgOiBcIlwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhZ2UgPSBuZXcgRXJyb3JQYWdlKFwiZXJyb3ItcGFnZVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYWdlKSB7XG4gICAgICAgICAgICBjb25zdCBwYWdlSFRNTCA9IHBhZ2UucmVuZGVyKClcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlLmFwcGVuZChwYWdlSFRNTClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZW5hYmxlUm91dGVDaGFuZ2UoKSB7XG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJoYXNoY2hhbmdlXCIsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBVUkxQYXJhbXM6IFVSTFBhcmFtcyA9IGdldFVSTFBhcmFtcyh3aW5kb3cubG9jYXRpb24uaGFzaClcbiAgICAgICAgICAgIEFwcC5yZW5kZXJOZXdQYWdlKFVSTFBhcmFtcylcbiAgICAgICAgfSlcblxuICAgICAgICB3aW5kb3cub25wb3BzdGF0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjaGVja0xvY2F0aW9uKCkge1xuXG5cbiAgICAgICAgY29uc3QgcGFnZUhUTUwgPSB0aGlzLmluaXRpYWxQYWdlLnJlbmRlcigpXG4gICAgICAgIHBhZ2VIVE1MLmlkID0gQXBwLmRlZmF1bHRQYWdlSWRcblxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQocGFnZUhUTUwpXG5cbiAgICAgICAgbGV0IFVSTFBhcmFtczogVVJMUGFyYW1zID0gZ2V0VVJMUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5oYXNoKVxuXG4gICAgICAgIGlmIChVUkxQYXJhbXMuaGFzaFBhZ2UpIHtcbiAgICAgICAgICAgIEFwcC5yZW5kZXJOZXdQYWdlKFVSTFBhcmFtcylcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJ1bigpIHtcbiAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuXG4gICAgICAgICAgICAvLyBjaGVja0xvY2FsU3RvcmFnZVxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKEhlYWRlcilcblxuICAgICAgICAgICAgLy8gY2hlY2sgVVJMIChwYXJhbXMpID0+IHBhcnNlIHBhcmFtcyA9PiBzZXQgcGFyYW1zXG4gICAgICAgICAgICB0aGlzLmNoZWNrTG9jYXRpb24oKVxuXG5cbiAgICAgICAgICAgIC8vIHJlbmRlciBVSVxuXG5cbiAgICAgICAgICAgIC8vIFBST0RVQ1RTXG4gICAgICAgICAgICAvLyByZW5kZXIgZmlsdGVyXG4gICAgICAgICAgICAvLyAgYWRkIGV2ZW50TGlzdGVuZXIgZm9ybSA9PiBjaGFuZ2UgVVJMID0+IHJlcmVuZGVyIHByb2R1Y3RzIGxpc3RcblxuICAgICAgICAgICAgLy8gcmVuZGVyIHByb2R1Y3RzXG4gICAgICAgICAgICAvLyAgYWRkRXZlbnRMaXN0ZW5lciBhZGQvcmVtb3ZlIHRvIGNhcnRcbiAgICAgICAgICAgIC8vICBhZGRFdmVudExpc3RlbmVyIG9wZW4gcHJvZHVjdFxuXG5cbiAgICAgICAgICAgIC8vIGxldCBhID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGVzdHR0XCIpXG4gICAgICAgICAgICAvLyBhLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKG5ld1VSTClcbiAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAvLyDQntCx0YDQsNCx0L7RgtGH0LjQuiDRgNC+0YPRgtGA0L7QslxuICAgICAgICAgICAgdGhpcy5lbmFibGVSb3V0ZUNoYW5nZSgpXG5cblxuICAgICAgICB9LCB0cnVlKVxuXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcHAiXSwibmFtZXMiOlsicHJvZHVjdHMiLCJmaWx0ZXJQYXJhbXMiLCJicmFuZCIsImNvbG9yIiwieWVhciIsInNlYXJjaFF1ZXJ5IiwiZmlsdGVyZWRQcm9kdWN0cyIsImNhcnQiLCJnZW5lcmF0ZVVSTCIsIm9iaiIsInN0ciIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJwYXJhbSIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImpvaW4iLCJmaWx0ZXIiLCJuIiwidGhpcyIsImdldFByb2R1Y3RzIiwicGFyYW1zIiwidXJsIiwiZWwiLCJ0b0xvd2VyQ2FzZSIsImRyYXciLCJkYXRhIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiZnJhZ21lbnQiLCJjcmVhdGVFbGVtZW50IiwiZm9yRWFjaCIsIml0ZW0iLCJpdGVtTm9kZSIsInRpdGxlIiwiYXBwZW5kIiwidGV4dENvbnRlbnQiLCJwcm9kdWN0IiwiZHJhd1Byb2R1Y3RzIiwidmFsdWVzIiwiaWQiLCJjb250YWluZXIiLCJjb250cm9sbGVyIiwidmlldyIsImNyZWF0ZUhlYWRlclRpdGxlIiwidGV4dCIsImhlYWRlclRpdGxlIiwiY3JlYXRlQ29udGVudFBhZ2UiLCJ0ZW1wbGF0ZSIsImNvbnRlbnQiLCJmaXJzdENoaWxkIiwiZW5hYmxlRmlsdGVyUHJvZHVjdHMiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsImNhdGVnb3J5IiwiZ2V0QXR0cmlidXRlIiwidmFsdWUiLCJjaGVja2VkIiwicHVzaCIsIm5ld1VSTCIsIndpbmRvdyIsImhpc3RvcnkiLCJwdXNoU3RhdGUiLCJyZW5kZXIiLCJpZFRhZyIsImlkRWxlbSIsImdldFVSTFBhcmFtcyIsImhhc2hQYWdlIiwic2xpY2UiLCJpZFByb2R1Y3QiLCJpbmNsdWRlcyIsInN1YnN0cmluZyIsImluZGV4T2YiLCJxdWVyeVBhcmFtcyIsImJvZHkiLCJpbml0aWFsUGFnZSIsInJlbmRlck5ld1BhZ2UiLCJjdXJyZW50UGFnZSIsImdldEVsZW1lbnRCeUlkIiwiQXBwIiwiZGVmYXVsdFBhZ2VJZCIsInBhZ2UiLCJwYWdlSFRNTCIsImVuYWJsZVJvdXRlQ2hhbmdlIiwiVVJMUGFyYW1zIiwibG9jYXRpb24iLCJoYXNoIiwib25wb3BzdGF0ZSIsImNvbnNvbGUiLCJsb2ciLCJjaGVja0xvY2F0aW9uIiwicnVuIl0sInNvdXJjZVJvb3QiOiIifQ==